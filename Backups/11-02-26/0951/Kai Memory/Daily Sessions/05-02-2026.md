# 05/02/2026 - Mind Knowledge Base App Development

## Summary
Major development session on the "Mind" offline knowledge management app for Pete. Built a Notion-like single-page application with extensive features.

## Completed Features

### Core Functionality
- [x] Working folder/note hierarchy with drag-and-drop
- [x] Tabbed note editing interface (multiple open notes)
- [x] Version history system (auto-saves last 50 versions per note)
- [x] Resizable/collapsible sidebar with persistence
- [x] Favorites system for quick access folders
- [x] Full-text search across notes

### UI/UX Polish
- [x] Notion-inspired color palette (#191919 dark bg, #2eaadc accent)
- [x] Migrated from emoji to Phosphor Icons (via CDN)
- [x] Dark/light theme support with proper toggle
- [x] Distraction-free focus mode
- [x] Mobile-responsive design

### Bug Fixes
- [x] Fixed folder rendering bug (parentId logic)
- [x] Added data repair for corrupted parent references
- [x] Fixed "+ New" button functionality
- [x] Fixed Full Width default to OFF (not inherited)
- [x] Fixed theme button icon switching

### Bookmark & Clipping Features
- [x] **Internal Bookmarks** - Bookmark notes for quick access in sidebar
- [x] **Clip Web Page** - Enter URL to fetch and save content offline
  - Uses jina.ai proxy for content extraction
  - Shows "Clipped Pages" section in sidebar
  - Preserves original URL with link
  - Works offline once clipped

### Editor Features
- [x] WYSIWYG rich text editor
- [x] Small text toggle
- [x] Full width toggle
- [x] Font family options (default, serif, mono)
- [x] Tag support
- [x] Backlinks panel
- [x] AI Suggest (integration ready)

## Technical Details
- **File**: `/Users/peteroberts/Documents/Kai/KnowledgeBase/index.html`
- **Storage**: localStorage/IndexedDB (completely offline)
- **Icons**: Phosphor Icons via unpkg CDN
- **CSS**: Custom with CSS variables for theming
- **Single-file**: Self-contained HTML, no build step

## Hosting Instructions Provided
Pete wants to host at **iamhicks.com**:
1. Create GitHub repo
2. Push index.html
3. Enable GitHub Pages
4. Set custom domain
5. Add DNS A records (GitHub Pages IPs)

## Next Steps
- Pete to test the Clip Web Page feature
- Pete to set up GitHub hosting for iamhicks.com
- Future: Consider service worker for true offline PWA experience

## Key Decisions
- Keeping it single-file HTML for simplicity
- Phosphor Icons for consistent, scalable iconography
- localStorage for data persistence (no backend needed)
- Notion aesthetic for familiar UX

---

## Later Conversation - Token Optimization & QMD

### Topics Discussed
- **QMD Plugin**: New in OpenClaw 2026.2.2 — searches local Markdown/Obsidian files and pulls only relevant snippets into prompts (60-97% token savings)
- **Token Usage Concerns**: Pete using Kimi K2.5 for everything, burning through API quota fast
- **Model Switching**: Can switch models mid-conversation with `/model k2`, `/model haiku`, etc. — no onboarding needed
- **Cost Optimization Strategy**: Use cheaper models (K2, Haiku) for simple tasks; reserve K2.5 for complex coding only
- **Memory Backup**: Confirmed daily memory files are working — this file exists and persists across sessions

---

## CRITICAL LESSONS LEARNED (DO NOT FORGET)

### What Went Wrong Today
1. **Overwrote files blindly** — Used `cp` without checking, destroyed working code multiple times
2. **Restored from wrong commits** — Each restore lost features, created Frankenstein versions
3. **Didn't commit frequently enough** — Hours of work between commits
4. **Didn't verify before deploy** — Assumed git history had complete versions
5. **Mixed up index.html and mind-demo/** — Root index is marketing site, mind-demo/ is the app

### Prevention Measures
1. **Commit every 30 minutes** — No exceptions
2. **Never `cp` files** — Use git checkout or explicit edits only
3. **Verify with grep** before assuming file has features
4. **Test locally** before every push
5. **Use explicit file paths** — Never rely on current directory assumptions

### Workflow for Future
1. Make changes locally
2. Test in browser (localhost)
3. `git diff` to verify changes
4. `git add -A && git commit -m "descriptive message"`
5. `git push origin main`
6. Wait 2-3 minutes for deploy
7. Test deployed version
8. Repeat

## UI Fixes Deployed (iamhicks.com/mind-demo/)

### 1. Folder Action Buttons (+ and ...)
- Fixed icon centering on hover by removing conflicting `::before` CSS pseudo-elements
- Added proper flexbox centering for Phosphor icon `<i>` elements

### 2. Hamburger Menu (☰)
- Changed from white Unicode character to grey Phosphor `ph-list` icon (`var(--text-secondary)`)
- Fixed `hide-desktop` class to only show on mobile (<=768px), hide on desktop

### 3. AI Settings Relocation
- Removed AI robot button from toolbar
- Added "AI Settings" section in Settings modal with "Configure AI" button
- Kept "Suggest Edits" (✨ sparkle) button in toolbar — relates to current note
- Clicking "Configure AI" opens the AI Panel modal

### 4. Theme Button Investigation
**Issue**: User reported theme button is "linked to Exit focus mode"
**Status**: Investigating — code shows correct event bindings:
- `themeBtn` → `toggleTheme()` (should toggle dark/light)
- `exitFocusBtn` → `toggleFocusMode()` (only shows when in focus mode)
**Need to verify**: Is the wrong function being called, or is there a CSS/layout issue?

---

### Action Items
- [ ] Pete to test `/model k2` to see if API keys work without additional setup
- [ ] Consider using cheaper models for research/formatting tasks
- [ ] Test the Mind app's "Clip Web Page" feature
- [ ] Redo bookmark competitor research (was lost in morning crash)
- [ ] Verify theme button behavior — clarify what "linked to Exit focus mode" means
